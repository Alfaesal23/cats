<html><head><title>Cats: Bifunctor</title><meta charset="utf-8" /><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" /><meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="author" content="Cats contributors" /><meta name="description" content="Lightweight, modular, and extensible library for functional programming" /><meta name="og:image" content="/cats/img/poster.png" /><meta name="og:title" content="Cats: Bifunctor" /><meta name="og:site_name" content="Cats" /><meta name="og:url" content="http://typelevel.org/cats/" /><meta name="og:type" content="website" /><meta name="og:description" content="Lightweight, modular, and extensible library for functional programming" /><link rel="icon" type="image/png" href="/cats/img/favicon.png" /><meta name="twitter:title" content="Cats: Bifunctor" /><meta name="twitter:image" content="http://typelevel.org/cats/img/poster.png" /><meta name="twitter:description" content="Lightweight, modular, and extensible library for functional programming" /><meta name="twitter:card" content="summary_large_image" /><link rel="icon" type="image/png" sizes="16x16" href="/cats/img/favicon16x16.png" /><link rel="icon" type="image/png" sizes="24x24" href="/cats/img/favicon24x24.png" /><link rel="icon" type="image/png" sizes="32x32" href="/cats/img/favicon32x32.png" /><link rel="icon" type="image/png" sizes="48x48" href="/cats/img/favicon48x48.png" /><link rel="icon" type="image/png" sizes="57x57" href="/cats/img/favicon57x57.png" /><link rel="icon" type="image/png" sizes="60x60" href="/cats/img/favicon60x60.png" /><link rel="icon" type="image/png" sizes="64x64" href="/cats/img/favicon64x64.png" /><link rel="icon" type="image/png" sizes="70x70" href="/cats/img/favicon70x70.png" /><link rel="icon" type="image/png" sizes="72x72" href="/cats/img/favicon72x72.png" /><link rel="icon" type="image/png" sizes="76x76" href="/cats/img/favicon76x76.png" /><link rel="icon" type="image/png" sizes="96x96" href="/cats/img/favicon96x96.png" /><link rel="icon" type="image/png" sizes="114x114" href="/cats/img/favicon114x114.png" /><link rel="icon" type="image/png" sizes="120x120" href="/cats/img/favicon120x120.png" /><link rel="icon" type="image/png" sizes="128x128" href="/cats/img/favicon128x128.png" /><link rel="icon" type="image/png" sizes="144x144" href="/cats/img/favicon144x144.png" /><link rel="icon" type="image/png" sizes="150x150" href="/cats/img/favicon150x150.png" /><link rel="icon" type="image/png" sizes="152x152" href="/cats/img/favicon152x152.png" /><link rel="icon" type="image/png" sizes="196x196" href="/cats/img/favicon196x196.png" /><link rel="icon" type="image/png" sizes="310x310" href="/cats/img/favicon310x310.png" /><link rel="icon" type="image/png" sizes="310x150" href="/cats/img/favicon310x150.png" /><link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" /><link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" /><link rel="stylesheet" href="/cats/highlight/styles/atom-one-light.css" /><link rel="stylesheet" href="/cats/css/style.css" /><link rel="stylesheet" href="/cats/css/palette.css" /><link rel="stylesheet" href="/cats/css/codemirror.css" /><link rel="stylesheet" href="/cats/css/override.css" /></head><body class="docs"><div id="wrapper"><div id="sidebar-wrapper"><ul id="sidebar" class="sidebar-nav"><li class="sidebar-brand"><a href="/cats/" class="brand"><div class="brand-wrapper"><span>Cats</span></div></a></li> <li><a href="/cats/typeclasses.html" class="">Type Classes</a></li> <li><a href="/cats/typeclasses/semigroup.html" class="">Semigroups and Monoids</a> <ul class="sub_section"> <li><a href="/cats/typeclasses/semigroup.html" class="">Semigroup</a></li> <li><a href="/cats/typeclasses/monoid.html" class="">Monoid</a></li></ul></li> <li><a href="/cats/typeclasses/applicativetraverse.html" class="">Applicative and Traversable Functors</a> <ul class="sub_section"> <li><a href="/cats/typeclasses/functor.html" class="">Functor</a></li> <li><a href="/cats/typeclasses/applicative.html" class="">Applicative</a></li> <li><a href="/cats/typeclasses/traverse.html" class="">Traverse</a></li></ul></li> <li><a href="/cats/typeclasses/monad.html" class="">Monads</a></li> <li><a href="/cats/typeclasses/functor.html" class="">Variance and Functors</a> <ul class="sub_section"> <li><a href="/cats/typeclasses/functor.html" class="">Functor</a></li> <li><a href="/cats/typeclasses/contravariant.html" class="">Contravariant</a></li> <li><a href="/cats/typeclasses/contravariantmonoidal.html" class="">ContravariantMonoidal</a></li> <li><a href="/cats/typeclasses/invariant.html" class="">Invariant</a></li> <li><a href="/cats/typeclasses/invariantmonoidal.html" class="">InvariantMonoidal</a></li></ul></li> <li><a href="/cats/typeclasses/alternative.html" class="">Alternative</a></li> <li><a href="/cats/typeclasses/bifunctor.html" class=" active ">Bifunctor</a></li> <li><a href="/cats/typeclasses/eq.html" class="">Eq</a></li> <li><a href="/cats/typeclasses/foldable.html" class="">Foldable</a></li> <li><a href="/cats/typeclasses/parallel.html" class="">Parallel</a></li> <li><a href="/cats/typeclasses/semigroupk.html" class="">SemigroupK</a></li> <li><a href="/cats/typeclasses/monoidk.html" class="">MonoidK</a></li> <li><a href="/cats/typeclasses/show.html" class="">Show</a></li> <li><a href="/cats/typeclasses/reducible.html" class="">Reducible</a></li> <li><a href="/cats/typeclasses/nonemptytraverse.html" class="">NonEmptyTraverse</a></li> <li><a href="/cats/typeclasses/arrow.html" class="">Arrow</a></li> <li><a href="/cats/typeclasses/lawtesting.html" class="">Law Testing</a></li>                   </ul></div><div id="page-content-wrapper"><div class="nav"><div class="container-fluid"><div class="row"><div class="col-lg-12"><div class="action-menu pull-left clearfix"><a href="#menu-toggle" id="menu-toggle"><i class="fa fa-bars" aria-hidden="true"></i></a></div><ul class="pull-right"><li id="gh-eyes-item" class="hidden-xs"><a href="https://github.com/typelevel/cats"><i class="fa fa-eye"></i><span>WATCH<span id="eyes" class="label label-default">--</span></span></a></li><li id="gh-stars-item" class="hidden-xs"><a href="https://github.com/typelevel/cats"><i class="fa fa-star-o"></i><span>STARS<span id="stars" class="label label-default">--</span></span></a></li><li><a href="#" onclick="shareSiteTwitter('Cats Lightweight, modular, and extensible library for functional programming');"><i class="fa fa-twitter"></i></a></li><li><a href="#" onclick="shareSiteFacebook('Cats Lightweight, modular, and extensible library for functional programming');"><i class="fa fa-facebook"></i></a></li><li><a href="#" onclick="shareSiteGoogle();"><i class="fa fa-google-plus"></i></a></li></ul></div></div></div></div><div id="content" data-github-owner="typelevel" data-github-repo="cats"><div class="content-wrapper"><section><h1 id="bifunctor">Bifunctor</h1>

<p><code class="highlighter-rouge">Bifunctor</code> takes two type parameters instead of one, and is a functor in both
of these parameters. It defines a function <code class="highlighter-rouge">bimap</code>, which allows for mapping over both
arguments at the same time. Its signature is as follows:</p>

<div class="language-scala highlighter-rouge"><pre class="highlight"><code><span class="k">def</span> <span class="n">bimap</span><span class="o">[</span><span class="kt">A</span>, <span class="kt">B</span>, <span class="kt">C</span>, <span class="kt">D</span><span class="o">](</span><span class="n">fab</span><span class="k">:</span> <span class="kt">F</span><span class="o">[</span><span class="kt">A</span>, <span class="kt">B</span><span class="o">])(</span><span class="n">f</span><span class="k">:</span> <span class="kt">A</span> <span class="o">=&gt;</span> <span class="n">C</span><span class="o">,</span> <span class="n">g</span><span class="k">:</span> <span class="kt">B</span> <span class="o">=&gt;</span> <span class="n">D</span><span class="o">)</span><span class="k">:</span> <span class="kt">F</span><span class="o">[</span><span class="kt">C</span>, <span class="kt">D</span><span class="o">]</span>
</code></pre>
</div>

<h2 id="either-as-a-bifunctor">Either as a Bifunctor</h2>

<p>Probably the most widely used Bifunctor instance is the Either data type.</p>

<p>Say you have a value that is either an error or a <code class="highlighter-rouge">ZonedDateTime</code> instance.
You also want to react to both possibilities - if there was a failure, you want to
convert it to your own <code class="highlighter-rouge">DomainError</code>, and if the result was a success, you want to
convert it to an UNIX timestamp.</p>

<div class="language-scala highlighter-rouge"><pre class="highlight"><code><span class="k">import</span> <span class="nn">cats._</span>
<span class="k">import</span> <span class="nn">cats.implicits._</span>
<span class="k">import</span> <span class="nn">java.time._</span>

<span class="k">case</span> <span class="k">class</span> <span class="nc">DomainError</span><span class="o">(</span><span class="n">message</span><span class="k">:</span> <span class="kt">String</span><span class="o">)</span>

<span class="k">def</span> <span class="n">dateTimeFromUser</span><span class="k">:</span> <span class="kt">Either</span><span class="o">[</span><span class="kt">Throwable</span>, <span class="kt">ZonedDateTime</span><span class="o">]</span> <span class="k">=</span> 
  <span class="nc">Right</span><span class="o">(</span><span class="nc">ZonedDateTime</span><span class="o">.</span><span class="n">now</span><span class="o">())</span>  <span class="c1">// Example definition
</span></code></pre>
</div>

<div class="language-scala highlighter-rouge"><pre class="highlight"><code><span class="n">dateTimeFromUser</span><span class="o">.</span><span class="n">bimap</span><span class="o">(</span>
  <span class="n">error</span> <span class="k">=&gt;</span> <span class="nc">DomainError</span><span class="o">(</span><span class="n">error</span><span class="o">.</span><span class="n">getMessage</span><span class="o">),</span>
  <span class="n">dateTime</span> <span class="k">=&gt;</span> <span class="n">dateTime</span><span class="o">.</span><span class="n">toEpochSecond</span>
<span class="o">)</span>
<span class="c1">// res0: Either[DomainError,Long] = Right(1557972753)
</span></code></pre>
</div>

<p><code class="highlighter-rouge">Bifunctor</code> also defines a convenience function called <code class="highlighter-rouge">leftMap</code>, which is defined as follows:</p>

<div class="language-scala highlighter-rouge"><pre class="highlight"><code><span class="k">def</span> <span class="n">leftMap</span><span class="o">[</span><span class="kt">A</span>, <span class="kt">B</span>, <span class="kt">C</span><span class="o">](</span><span class="n">fab</span><span class="k">:</span> <span class="kt">F</span><span class="o">[</span><span class="kt">A</span>, <span class="kt">B</span><span class="o">])(</span><span class="n">f</span><span class="k">:</span> <span class="kt">A</span> <span class="o">=&gt;</span> <span class="n">C</span><span class="o">)</span><span class="k">:</span> <span class="kt">F</span><span class="o">[</span><span class="kt">C</span>, <span class="kt">B</span><span class="o">]</span> <span class="k">=</span> <span class="n">bimap</span><span class="o">(</span><span class="n">fab</span><span class="o">)(</span><span class="n">f</span><span class="o">,</span> <span class="n">identity</span><span class="o">)</span>
</code></pre>
</div>

<p>There is no <code class="highlighter-rouge">rightMap</code> however - use <code class="highlighter-rouge">map</code> instead. The reasoning behind this is that in Cats, the instances of
<code class="highlighter-rouge">Bifunctor</code> are also mostly instances of <code class="highlighter-rouge">Functor</code>, as it is the case with <code class="highlighter-rouge">Either</code>.</p>

<h2 id="tuple2-as-a-bifunctor">Tuple2 as a Bifunctor</h2>

<p>Another very popular <code class="highlighter-rouge">Bifunctor</code> is that for the <code class="highlighter-rouge">Tuple2</code> data type, or <code class="highlighter-rouge">(A, B)</code> for types <code class="highlighter-rouge">A</code> and <code class="highlighter-rouge">B</code>.</p>

<p>Let’s say we have a list of balances and want divide them by the number of months in the lifetime of the account holder. The balances are given in cents.
A bit contrived, but we want an average contribution per month to the given account. We want the result in dollars per month. The lifetime is given in the number of years the account has been active.</p>

<div class="language-scala highlighter-rouge"><pre class="highlight"><code><span class="k">val</span> <span class="n">records</span><span class="k">:</span> <span class="kt">List</span><span class="o">[(</span><span class="kt">Int</span>, <span class="kt">Int</span><span class="o">)]</span> <span class="k">=</span> <span class="nc">List</span><span class="o">((</span><span class="mi">450000</span><span class="o">,</span> <span class="mi">3</span><span class="o">),</span> <span class="o">(</span><span class="mi">770000</span><span class="o">,</span> <span class="mi">4</span><span class="o">),</span> <span class="o">(</span><span class="mi">990000</span><span class="o">,</span> <span class="mi">2</span><span class="o">),</span> <span class="o">(</span><span class="mi">2100</span><span class="o">,</span> <span class="mi">4</span><span class="o">),</span> <span class="o">(</span><span class="mi">43300</span><span class="o">,</span> <span class="mi">3</span><span class="o">))</span>
<span class="c1">// records: List[(Int, Int)] = List((450000,3), (770000,4), (990000,2), (2100,4), (43300,3))
</span>
<span class="k">def</span> <span class="n">calculateContributionPerMonth</span><span class="o">(</span><span class="n">balance</span><span class="k">:</span> <span class="kt">Int</span><span class="o">,</span> <span class="n">lifetime</span><span class="k">:</span> <span class="kt">Int</span><span class="o">)</span> <span class="k">=</span> <span class="n">balance</span> <span class="o">/</span> <span class="n">lifetime</span>
<span class="c1">// calculateContributionPerMonth: (balance: Int, lifetime: Int)Int
</span>
<span class="k">val</span> <span class="n">result</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="k">=</span>
  <span class="n">records</span><span class="o">.</span><span class="n">map</span><span class="o">(</span>
      <span class="n">record</span> <span class="k">=&gt;</span> <span class="n">record</span><span class="o">.</span><span class="n">bimap</span><span class="o">(</span>
        <span class="n">cents</span> <span class="k">=&gt;</span> <span class="n">cents</span> <span class="o">/</span> <span class="mi">100</span><span class="o">,</span>
        <span class="n">years</span> <span class="k">=&gt;</span> <span class="mi">12</span> <span class="o">*</span> <span class="n">years</span>
      <span class="o">)</span>
    <span class="o">).</span><span class="n">map</span><span class="o">((</span><span class="n">calculateContributionPerMonth</span> <span class="k">_</span><span class="o">).</span><span class="n">tupled</span><span class="o">)</span>
<span class="c1">// result: List[Int] = List(125, 160, 412, 0, 12)
</span></code></pre>
</div>

<p>As you can see, this instance makes it convenient to process two related pieces of data in independent ways, especially when there is no state relationship between the two until processing is complete.</p>

<p>Note that, just as with the bifunctor for <code class="highlighter-rouge">Either</code>, we do not have a <code class="highlighter-rouge">rightMap</code> function since the relevant instances of <code class="highlighter-rouge">Bifunctor</code> induce a <code class="highlighter-rouge">Functor</code> in the second argument, so we just use <code class="highlighter-rouge">map</code>.</p>
</section></div></div></div></div><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script><script src="/cats/highlight/highlight.pack.js"></script><script>hljs.configure({
languages:['scala','java','bash']
});
hljs.initHighlighting();
             </script><script>((window.gitter = {}).chat = {}).options = {
room: 'typelevel/cats'};</script><script src="https://sidecar.gitter.im/dist/sidecar.v1.js"></script><script src="/cats/js/main.js"></script></body></html>